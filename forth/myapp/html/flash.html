<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>flash</title>
<link rel="stylesheet" href="doc.css">
</head>
<body>
<h1>flash</h1>
<pre class="forth">
<font color=black>
<hr>

</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>SPI flash 

</font><font color=#00AAAA><a href = "root.html#1.1290" style="text-decoration: none; color: #00AAAA">there</a> 

</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>I/O registers      Read        Write 
</font><font color=#AA0000>4 </font><font color=#00AAAA><a href = "root.html#1.0140" style="text-decoration: none; color: #00AAAA">equ</a> </font><font color=#AA00AA>SPIdata   &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>retrig      spitx 
</font><font color=#AA0000>5 </font><font color=#00AAAA><a href = "root.html#1.0140" style="text-decoration: none; color: #00AAAA">equ</a> </font><font color=#AA00AA>SPIformat  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>result      format 

</font><font color=#AA0000>27182 </font><font color=#00AAAA><a href = "root.html#1.0140" style="text-decoration: none; color: #00AAAA">equ</a> </font><font color=#AA00AA>flwp_en  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4021 -- x\ enable for flash-wp. 

</font><font color=#00AAAA><a href = "root.html#1.1130" style="text-decoration: none; color: #00AAAA">variable</a> </font><font color=#AA00AA>fwren0 </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>lowest 64K sector number, set by `fwall` 
</font><font color=#00AAAA><a href = "root.html#1.1130" style="text-decoration: none; color: #00AAAA">variable</a> </font><font color=#AA00AA>fwren1 </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>inverse of fwren0, used as a backup. Must be ~fwren0. 
</font><font color=#00AAAA><a href = "root.html#1.1130" style="text-decoration: none; color: #00AAAA">variable</a> </font><font color=#AA00AA>sector </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4000 -- a-addr 
</font><font color=#00AAAA><a href = "root.html#1.1130" style="text-decoration: none; color: #00AAAA">variable</a> </font><font color=#AA00AA>fp    &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4010 -- a-addr 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>flash-wp     &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4020 sector key -- 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#2.4021" style="text-decoration: none; color: #AA00AA">flwp_en</a> </font><font color=#FF00FF><a href = "root.html#1.2060" style="text-decoration: none; color: #FF00FF">xor</a> </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a>  </font><font color=#FF00FF><a href = "root.html#1.2130" style="text-decoration: none; color: #FF00FF">drop</a> </font><font color=#00AAAA><a href = "root.html#1.1230" style="text-decoration: none; color: #00AAAA">exit</a>  <a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a> 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">fwren0</a> </font><font color=#0000FF><a href = "forth.html#2.0200" style="text-decoration: none; color: #0000FF">!</a>  </font><font color=#FF00FF><a href = "root.html#1.2010" style="text-decoration: none; color: #FF00FF">invert</a> </font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">fwren1</a> </font><font color=#0000FF><a href = "forth.html#2.0200" style="text-decoration: none; color: #0000FF">!</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#AA0000>0 </font><font color=#AA00AA><a href = "forth.html#2.4021" style="text-decoration: none; color: #AA00AA">flwp_en</a> </font><font color=#0000FF><a href = "forth.html#2.4020" style="text-decoration: none; color: #0000FF">flash-wp</a> </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>testing 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>readSPI  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>-- c \ result of transfer 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">SPIformat</a> </font><font color=#0000FF><a href = "forth.html#2.0110" style="text-decoration: none; color: #0000FF">io@</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>SPIcommand  </font><font color=#AA0000>1 </font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">SPIformat</a> </font><font color=#0000FF><a href = "forth.html#2.0120" style="text-decoration: none; color: #0000FF">io!</a> </font><font color=#00AAAA><a href = "root.html#1.1170" style="text-decoration: none; color: #00AAAA">[</a> <a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>   &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>c --\ activate CS line 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>sendSPI    &nbsp;</font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">SPIdata</a> </font><font color=#0000FF><a href = "forth.html#2.0120" style="text-decoration: none; color: #0000FF">io!</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>         &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>c --\ transmit an SPI byte 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>]read      &nbsp;</font><font color=#AA0000>0 </font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">SPIformat</a> </font><font color=#0000FF><a href = "forth.html#2.0120" style="text-decoration: none; color: #0000FF">io!</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>        &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4080 --\ end read 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>fl_wren    &nbsp;</font><font color=#AA0000>6 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a> <a href = "forth.html#2.4080" style="text-decoration: none; color: #0000FF">]read</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>  <a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>write enable 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>fl_wrdi    &nbsp;</font><font color=#AA0000>4 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a> <a href = "forth.html#2.4080" style="text-decoration: none; color: #0000FF">]read</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>  <a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>write disable 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>waitflash  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>--                      \ wait for write or erase to finish 
   &nbsp;</font><font color=#00AAAA><a href = "root.html#1.2900" style="text-decoration: none; color: #00AAAA">begin</a>  </font><font color=#AA0000>5 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a>  </font><font color=#AA0000>0 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a> 
          &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">readSPI</a> <a href = "forth.html#2.4080" style="text-decoration: none; color: #0000FF">]read</a>  </font><font color=#AA0000>1 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> 
   &nbsp;</font><font color=#00AAAA><a href = "root.html#1.2960" style="text-decoration: none; color: #00AAAA">while</a>  </font><font color=#0000FF><a href = "forth.html#2.0100" style="text-decoration: none; color: #0000FF">noop</a> 
   &nbsp;</font><font color=#00AAAA><a href = "root.html#1.2970" style="text-decoration: none; color: #00AAAA">repeat</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>sendaddr24  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>addr --     \ send address 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#2.4000" style="text-decoration: none; color: #AA00AA">sector</a> </font><font color=#0000FF><a href = "forth.html#2.0210" style="text-decoration: none; color: #0000FF">@</a> <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a> 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> <a href = "root.html#1.2640" style="text-decoration: none; color: #FF00FF">swapb</a> </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>]write  &nbsp;</font><font color=#0000FF><a href = "forth.html#2.4080" style="text-decoration: none; color: #0000FF">]read</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">fl_wrdi</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>            &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4050 -- 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>f>      &nbsp;</font><font color=#AA0000>0 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">readSPI</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>        &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4070 c -- 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>mask16b  </font><font color=#AA0000>65535 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>                 &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>x -- x16 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>is4K?  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>fa -- fa flag \ is the pointer at a new sector? 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#AA0000>4095 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> <a href = "root.html#1.2150" style="text-decoration: none; color: #FF00FF">0=</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>is256?  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>fa -- fa flag \ is the pointer at a new page? 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#AA0000>255 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> <a href = "root.html#1.2150" style="text-decoration: none; color: #FF00FF">0=</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>erase4K  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>fa -- fa \ erase the 4K sector here 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">fl_wren</a>  </font><font color=#AA0000>32 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a>  </font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendaddr24</a>  <a href = "forth.html#2.4080" style="text-decoration: none; color: #0000FF">]read</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>write[  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4030 fa -- 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">fwren0</a> </font><font color=#0000FF><a href = "forth.html#2.0210" style="text-decoration: none; color: #0000FF">@</a>  </font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> <a href = "root.html#1.2010" style="text-decoration: none; color: #FF00FF">invert</a> 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#(null)" style="text-decoration: none; color: #AA00AA">fwren1</a> </font><font color=#0000FF><a href = "forth.html#2.0210" style="text-decoration: none; color: #0000FF">@</a>  <a href = "forth.html#2.0135" style="text-decoration: none; color: #0000FF"><></a> </font><font color=#AA0000>-81 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> </font><font color=#0000FF><a href = "forth.html#2.0020" style="text-decoration: none; color: #0000FF">exception</a>     &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>corrupted wall 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#2.4000" style="text-decoration: none; color: #AA00AA">sector</a> </font><font color=#0000FF><a href = "forth.html#2.0210" style="text-decoration: none; color: #0000FF">@</a>  <a href = "forth.html#2.0140" style="text-decoration: none; color: #0000FF"><</a>  </font><font color=#AA0000>-82 </font><font color=#FF00FF><a href = "root.html#1.2070" style="text-decoration: none; color: #FF00FF">and</a> </font><font color=#0000FF><a href = "forth.html#2.0020" style="text-decoration: none; color: #0000FF">exception</a>     &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>under the wall 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#AA00AA><a href = "forth.html#2.4010" style="text-decoration: none; color: #AA00AA">fp</a> </font><font color=#0000FF><a href = "forth.html#2.0200" style="text-decoration: none; color: #0000FF">!</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">waitflash</a> 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">is4K?</a> </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a> </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">erase4K</a> </font><font color=#00AAAA><a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a> 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">fl_wren</a>  </font><font color=#AA0000>2 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendaddr24</a>  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>start page write 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>bump_fp  </font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>-- fa \ Bump flash pointer by 1, wrap at 64K boundary 
   &nbsp;</font><font color=#AA00AA><a href = "forth.html#2.4010" style="text-decoration: none; color: #AA00AA">fp</a> </font><font color=#0000FF><a href = "forth.html#2.0210" style="text-decoration: none; color: #0000FF">@</a>  </font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">mask16b</a>                  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1010" style="text-decoration: none; color: #00AAAA">(</a> </font><font color=#008800>fa fa16  )
   &nbsp;</font><font color=#AA0000>65535 </font><font color=#0000FF><a href = "forth.html#2.0130" style="text-decoration: none; color: #0000FF">=</a> </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a> </font><font color=#AA0000>1 </font><font color=#AA00AA><a href = "forth.html#2.4000" style="text-decoration: none; color: #AA00AA">sector</a> </font><font color=#0000FF><a href = "forth.html#2.0400" style="text-decoration: none; color: #0000FF">+!</a> </font><font color=#00AAAA><a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a>        &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>bump sector if fp will wrap 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#2.0360" style="text-decoration: none; color: #0000FF">1+</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">mask16b</a>  </font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#AA00AA><a href = "forth.html#2.4010" style="text-decoration: none; color: #AA00AA">fp</a> </font><font color=#0000FF><a href = "forth.html#2.0200" style="text-decoration: none; color: #0000FF">!</a>              &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>bump fp 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>>f     &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4040 c --\ Write next byte to flash 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">bump_fp</a> 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">is256?</a> </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a>  </font><font color=#0000FF><a href = "forth.html#2.4050" style="text-decoration: none; color: #0000FF">]write</a>     &nbsp;</font><font color=#00AAAA><a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a>        &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>end write at end of page 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">is4K?</a>  </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a>  </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">erase4K</a>    &nbsp;</font><font color=#00AAAA><a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a> 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">is256?</a> </font><font color=#00AAAA><a href = "root.html#1.2930" style="text-decoration: none; color: #00AAAA">if</a>  </font><font color=#FF00FF><a href = "root.html#1.2100" style="text-decoration: none; color: #FF00FF">dup</a> </font><font color=#0000FF><a href = "forth.html#2.4030" style="text-decoration: none; color: #0000FF">write[</a>  </font><font color=#00AAAA><a href = "root.html#1.2950" style="text-decoration: none; color: #00AAAA">then</a>        &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>start a new page 
   &nbsp;</font><font color=#FF00FF><a href = "root.html#1.2130" style="text-decoration: none; color: #FF00FF">drop</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 
</font><font color=#00AAAA><a href = "root.html#1.1220" style="text-decoration: none; color: #00AAAA">:noname</a>  </font><font color=#0000FF><a href = "forth.html#2.3110" style="text-decoration: none; color: #0000FF">count</a>  <a href = "forth.html#2.4040" style="text-decoration: none; color: #0000FF">>f</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>    &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>Write string to flash 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>write  </font><font color=#00AAAA><a href = "root.html#1.1260" style="text-decoration: none; color: #00AAAA">literal</a> </font><font color=#0000FF><a href = "forth.html#2.0405" style="text-decoration: none; color: #0000FF">times</a>  </font><font color=#FF00FF><a href = "root.html#1.2130" style="text-decoration: none; color: #FF00FF">drop</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>   &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4045 c-addr u -- 

</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>read[  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4060 fa --\ Begin fast read 
   &nbsp;</font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">waitflash</a>  </font><font color=#AA0000>11 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">SPIcommand</a>  <a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendaddr24</a>  </font><font color=#AA0000>0 </font><font color=#0000FF><a href = "forth.html#(null)" style="text-decoration: none; color: #0000FF">sendSPI</a> 
</font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a> 

</font><font color=#00AAAA><a href = "root.html#1.1220" style="text-decoration: none; color: #00AAAA">:noname</a>  </font><font color=#0000FF><a href = "forth.html#2.4070" style="text-decoration: none; color: #0000FF">f></a> </font><font color=#FF00FF><a href = "root.html#1.2110" style="text-decoration: none; color: #FF00FF">over</a> </font><font color=#0000FF><a href = "forth.html#2.0180" style="text-decoration: none; color: #0000FF">c!</a> <a href = "forth.html#2.0350" style="text-decoration: none; color: #0000FF">char+</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>   &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>Read string from flash 
</font><font color=#00AAAA><a href = "root.html#1.1210" style="text-decoration: none; color: #00AAAA">:</a> </font><font color=#FF0000>read  &nbsp;</font><font color=#00AAAA><a href = "root.html#1.1260" style="text-decoration: none; color: #00AAAA">literal</a> </font><font color=#0000FF><a href = "forth.html#2.0405" style="text-decoration: none; color: #0000FF">times</a> </font><font color=#FF00FF><a href = "root.html#1.2130" style="text-decoration: none; color: #FF00FF">drop</a> </font><font color=#00AAAA><a href = "root.html#1.1240" style="text-decoration: none; color: #00AAAA">;</a>    &nbsp;<a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>2.4090 c-addr u -- 

</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>Bootloader commands: 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`<space>` Launch the app (if possible) 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`!` Write next SPI byte, expect 2 hex digits. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`@` Read next SPI byte, return 2 hex digits. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`#` Start a SPI flash command, expect 2 hex digits. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`$` Stop SPI flash command, return `.` when flash is not busy. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`%` ROM version, return 2 hex digits. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`&` Bootloader format, return 2 hex digits. 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`'` nop 
</font><font color=#00AAAA><a href = "root.html#1.1020" style="text-decoration: none; color: #00AAAA">\</a> </font><font color=#008800>`other` Ignored. 


</font><font color=#00AAAA><a href = "root.html#1.1290" style="text-decoration: none; color: #00AAAA">there</a> </font><font color=#FF00FF><a href = "root.html#1.2120" style="text-decoration: none; color: #FF00FF">swap</a> <a href = "root.html#1.2090" style="text-decoration: none; color: #FF00FF">-</a> </font><font color=#0000FF><a href = "forth.html#2.3300" style="text-decoration: none; color: #0000FF">.</a> </font><font color=#00AAAA><a href = "root.html#1.1030" style="text-decoration: none; color: #00AAAA">.(</a> </font><font color=#008800>instructions used by flash access )</font><font color=#0000FF><a href = "forth.html#2.2111" style="text-decoration: none; color: #0000FF">cr</a> 
</pre>
</body>
</html>
