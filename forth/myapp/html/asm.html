<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <title>Assembler Reference</title>
    <link rel="stylesheet" href="doc.css">
    <!--[if IE]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
<body>
<h1>Assembler Reference</h1>
<hr>
<p>Execution: The simulator executes one instruction.
<br>Compilation: One instruction is appended to code space.
</p>
<hr>
<h2>Instruction Compile</h2>
<hr>
<a name="1.9070"></a>
<h3><ref>1.9070:</ref> <chad>imm</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile ALU instruction
</p>
<a name="1.9060"></a>
<h3><ref>1.9060:</ref> <chad>cop</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile coprocessor instruction. Not used.
</p>
<a name="1.9050"></a>
<h3><ref>1.9050:</ref> <chad>litx</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile <tok>litx</tok> instruction
</p>
<a name="1.9040"></a>
<h3><ref>1.9040:</ref> <chad>scall</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile <tok>call</tok> instruction
</p>
<a name="1.9030"></a>
<h3><ref>1.9030:</ref> <chad>0branch</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile <tok>zjump</tok> instruction
</p>
<a name="1.9020"></a>
<h3><ref>1.9020:</ref> <chad>branch</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile <tok>jump</tok> instruction
</p>
<a name="1.9010"></a>
<h3><ref>1.9010:</ref> <chad>alu</chad> <com><i>( n -- 0 )</i></com></h3>

<p> Compile <tok>ALU</tok> instruction
</p>
<hr><h2>Stack pointer fields</h2>
<hr><a name="1.8040"></a>
<h3><ref>1.8040:</ref> <chad>d-1</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p> Pop from data stack.
</p>
<a name="1.8030"></a>
<h3><ref>1.8030:</ref> <chad>d+1</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p> Push to data stack.
</p>
<a name="1.8020"></a>
<h3><ref>1.8020:</ref> <chad>r-1</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p> Pop from return stack.
</p>
<a name="1.8010"></a>
<h3><ref>1.8010:</ref> <chad>r+1</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p> Push to return stack.
</p>
<hr><h2>ALU strobes</h2>
<hr><a name="1.7070"></a>
<h3><ref>1.7070:</ref> <chad>CO</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>carry = T[0]; W = T.
</p>
<a name="1.7060"></a>
<h3><ref>1.7060:</ref> <chad>_MEMRD_</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>Generate a memory read strobe.
RA = T.
</p>
<a name="1.7050"></a>
<h3><ref>1.7050:</ref> <chad>_IORD_</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>Generate an I/O read strobe.
RA = T.
</p>
<a name="1.7040"></a>
<h3><ref>1.7040:</ref> <chad>N-&gt;io[T]</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>Generate an I/O write strobe.
</p>
<a name="1.7030"></a>
<h3><ref>1.7030:</ref> <chad>N-&gt;[T]</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>Generate a memory write strobe.
</p>
<a name="1.7020"></a>
<h3><ref>1.7020:</ref> <chad>T-&gt;R</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>R = T
</p>
<a name="1.7010"></a>
<h3><ref>1.7010:</ref> <chad>T-&gt;N</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>N = T
</p>
<hr><h2>ALU operations</h2>
<hr><a name="1.6260"></a>
<h3><ref>1.6260:</ref> <chad>status</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = (rp&lt;&lt;8) | sp
</p>
<a name="1.6250"></a>
<h3><ref>1.6250:</ref> <chad>io[T]</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = mem[RA] (see <tok>_IORD_</tok>)
</p>
<a name="1.6240"></a>
<h3><ref>1.6240:</ref> <chad>[T]</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = mem[RA] (see <tok>_MEMRD_</tok>)
</p>
<a name="1.6230"></a>
<h3><ref>1.6230:</ref> <chad>R-1</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = R - 1
</p>
<a name="1.6220"></a>
<h3><ref>1.6220:</ref> <chad>R</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = R
</p>
<a name="1.6190"></a>
<h3><ref>1.6190:</ref> <chad>T0=</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = all &apos;1&apos;s if T=0 else all &apos;0&apos;s 
</p>
<a name="1.6170"></a>
<h3><ref>1.6170:</ref> <chad>N-T</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = N - T
</p>
<a name="1.6150"></a>
<h3><ref>1.6150:</ref> <chad>T+N</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = N + T
</p>
<a name="1.6140"></a>
<h3><ref>1.6140:</ref> <chad>&gt;&lt;16</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = ((T&gt;&gt;16) &amp; 0xFFFF) | ((T &amp; 0xFFFF) &lt;&lt; 16) (swap 16-bit halves)
</p>
<a name="1.6130"></a>
<h3><ref>1.6130:</ref> <chad>&gt;&lt;</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = ((T&gt;&gt;8) &amp; 0xFF00FF) | ((T &amp; 0xFF00FF)&lt;&lt;8) (swap even/odd bytes)
</p>
<a name="1.6120"></a>
<h3><ref>1.6120:</ref> <chad>T&amp;N</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = N &amp; T
</p>
<a name="1.6110"></a>
<h3><ref>1.6110:</ref> <chad>~T</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = ~T
</p>
<a name="1.6100"></a>
<h3><ref>1.6100:</ref> <chad>T^N</chad> <com><i>( n1 -- n2 )</i></com></h3>
<a name="1.6090"></a>
<h3><ref>1.6090:</ref> <chad>W</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = W
</p>
<a name="1.6080"></a>
<h3><ref>1.6080:</ref> <chad>N</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = N
</p>
<a name="1.6070"></a>
<h3><ref>1.6070:</ref> <chad>T2*c</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = T * 2 + carry
</p>
<a name="1.6060"></a>
<h3><ref>1.6060:</ref> <chad>T2*</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = T * 2
</p>
<a name="1.6050"></a>
<h3><ref>1.6050:</ref> <chad>cT2/</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = carry-in T / 2.
</p>
<a name="1.6040"></a>
<h3><ref>1.6040:</ref> <chad>T2/</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = signed T / 2.
</p>
<a name="1.6030"></a>
<h3><ref>1.6030:</ref> <chad>C</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = carry flag.
</p>
<a name="1.6020"></a>
<h3><ref>1.6020:</ref> <chad>T0&lt;</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>All bits in T = MSB(T).
</p>
<a name="1.6010"></a>
<h3><ref>1.6010:</ref> <chad>COP</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>T = 0, place holder for coprocessor result.
</p>
<a name="1.6000"></a>
<h3><ref>1.6000:</ref> <chad>T</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>No change in T.
</p>
<hr><h2>Flow Control</h2>
<hr><a name="1.5020"></a>
<h3><ref>1.5020:</ref> <chad>RET</chad> <com><i>( n1 -- n2 )</i></com></h3>

<p>Set the ALU instruction <tok>ret</tok> bit.
</p>
<a name="1.5010"></a>
<h3><ref>1.5010:</ref> <chad>;CODE</chad> <com><i>( 0 -- )</i></com></h3>

<p>End a code definition.
</p>
<a name="1.5170"></a>
<h3><ref>1.5170:</ref> <chad>repeat</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>repeat</tok>.
</p>
<a name="1.5160"></a>
<h3><ref>1.5160:</ref> <chad>while</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>while</tok>.
</p>
<a name="1.5150"></a>
<h3><ref>1.5150:</ref> <chad>then</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>then</tok>.
</p>
<a name="1.5140"></a>
<h3><ref>1.5140:</ref> <chad>else</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>else</tok>.
</p>
<a name="1.5130"></a>
<h3><ref>1.5130:</ref> <chad>if</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>if</tok>.
</p>
<a name="1.5120"></a>
<h3><ref>1.5120:</ref> <chad>until</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>until</tok>.
</p>
<a name="1.5110"></a>
<h3><ref>1.5110:</ref> <chad>again</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>again</tok>.
</p>
<a name="1.5100"></a>
<h3><ref>1.5100:</ref> <chad>begin</chad> <com><i>( -- )</i></com></h3>

<p>Assembler version of <tok>begin</tok>.
</p>
</body>
</html>
